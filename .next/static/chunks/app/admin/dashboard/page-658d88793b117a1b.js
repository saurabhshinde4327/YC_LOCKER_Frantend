(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[957],{1502:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(5155),r=s(2115),i=s(5695),n=s(3464),l=s(3568),o=s(6408),c=s(5171);function d(){let e=(0,i.useRouter)(),[t,s]=(0,r.useState)([]),[d,x]=(0,r.useState)([]),[m,u]=(0,r.useState)(""),[h,p]=(0,r.useState)(""),[g,f]=(0,r.useState)(!0),[y,j]=(0,r.useState)(0),[v,w]=(0,r.useState)(null),N=(0,r.useCallback)(async()=>{try{let t=localStorage.getItem("token");if(!t)return void e.push("/admin");let a=await n.A.get((0,c.e)("api/admin/users"),{headers:{Authorization:"Bearer ".concat(t)}});s(a.data),x(a.data);let r=a.data.reduce((e,t)=>e+(t.storageUsed||0),0);j(r)}catch(s){var t;l.Ay.error("Failed to fetch data"),n.A.isAxiosError(s)&&(null==(t=s.response)?void 0:t.status)===401&&e.push("/admin")}finally{f(!1)}},[e]),b=async e=>{if(confirm("Are you sure you want to delete this user? This action cannot be undone.")){w(e);try{let a=localStorage.getItem("token");await n.A.delete((0,c.e)("api/admin/users/".concat(e)),{headers:{Authorization:"Bearer ".concat(a)}}),l.Ay.success("User deleted successfully"),s(t.filter(t=>t._id!==e)),x(d.filter(t=>t._id!==e))}catch(e){if(n.A.isAxiosError(e)){var a,r;l.Ay.error((null==(r=e.response)||null==(a=r.data)?void 0:a.error)||"Failed to delete user")}else l.Ay.error("Failed to delete user")}finally{w(null)}}};return((0,r.useEffect)(()=>{N();let e=setInterval(N,3e4);return()=>clearInterval(e)},[e,N]),(0,r.useEffect)(()=>{x(t.filter(e=>{let t=e.name.toLowerCase().includes(m.toLowerCase())||e.studentId.toLowerCase().includes(m.toLowerCase())||e.email.toLowerCase().includes(m.toLowerCase())||e.phone.includes(m),s=""===h||e.department===h;return t&&s}))},[m,t,h]),g)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsx)("div",{className:"text-2xl text-gray-600",children:"Loading..."})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"})}),(0,a.jsxs)("div",{className:"mb-8 flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-md w-full sm:w-auto",children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-1 text-gray-600",children:"Total Storage Used"}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-48 bg-gray-200 rounded-full h-2",children:(0,a.jsx)(o.P.div,{className:"h-2 rounded-full ".concat(y/536870912e3*100>90?"bg-red-500":y/536870912e3*100>70?"bg-yellow-500":"bg-green-500"),initial:{width:0},animate:{width:"".concat(y/536870912e3*100,"%")},transition:{duration:.5}})}),(0,a.jsxs)("span",{className:"text-sm whitespace-nowrap text-gray-700",children:[Math.round(y/0x40000000)," / 500 GB"]})]})]}),(0,a.jsxs)("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),e.push("/admin")},className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-gray-800 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})]}),(0,a.jsxs)(o.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white shadow-lg rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-5 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Users"}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["Showing ",d.length," of ",t.length," users"]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 w-full sm:w-auto",children:[(0,a.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"block w-full sm:w-48 pl-4 pr-10 py-3 bg-white border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none",children:[(0,a.jsx)("option",{value:"",children:"All Departments"}),(0,a.jsx)("option",{value:"botany",children:"Botany"}),(0,a.jsx)("option",{value:"chemistry",children:"Chemistry"}),(0,a.jsx)("option",{value:"electronics",children:"Electronics"}),(0,a.jsx)("option",{value:"english",children:"English"}),(0,a.jsx)("option",{value:"mathematics",children:"Mathematics"}),(0,a.jsx)("option",{value:"microbiology",children:"Microbiology"}),(0,a.jsx)("option",{value:"sports",children:"Sports"}),(0,a.jsx)("option",{value:"statistics",children:"Statistics"}),(0,a.jsx)("option",{value:"zoology",children:"Zoology"}),(0,a.jsx)("option",{value:"animation-science",children:"Animation Science"}),(0,a.jsx)("option",{value:"data-science",children:"Data Science"}),(0,a.jsx)("option",{value:"artificial-intelligence",children:"Artificial Intelligence"}),(0,a.jsx)("option",{value:"bvoc-software-development",children:"B.Voc Software Development"}),(0,a.jsx)("option",{value:"bioinformatics",children:"Bioinformatics"}),(0,a.jsx)("option",{value:"computer-application",children:"Computer Application"}),(0,a.jsx)("option",{value:"computer-science-entire",children:"Computer Science (Entire)"}),(0,a.jsx)("option",{value:"computer-science-optional",children:"Computer Science (Optional)"}),(0,a.jsx)("option",{value:"drug-chemistry",children:"Drug Chemistry"}),(0,a.jsx)("option",{value:"food-technology",children:"Food Technology"}),(0,a.jsx)("option",{value:"forensic-science",children:"Forensic Science"}),(0,a.jsx)("option",{value:"nanoscience-and-technology",children:"Nanoscience and Technology"})]}),(0,a.jsxs)("div",{className:"relative rounded-lg shadow-sm w-full sm:w-72",children:[(0,a.jsx)("input",{type:"text",value:m,onChange:e=>u(e.target.value),placeholder:"Search by name, ID, email, or phone...",className:"block w-full pl-4 pr-10 py-3 bg-white border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none"}),(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})]})]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact Info"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student ID"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Storage Used"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Storage %"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[d.map(e=>{var t;let s=Math.round(e.storageUsed/1024/1024),r=e.storageUsed/0x40000000*100;return(0,a.jsxs)(o.P.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"hover:bg-gray-50 transition-colors duration-150",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm text-gray-900",children:e.email}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.phone})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:e.studentId})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:(t=e.department)?t.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase()):""})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[s," MB"]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"flex-grow",children:(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)(o.P.div,{className:"h-2 rounded-full ".concat(r>90?"bg-red-500":r>70?"bg-yellow-500":"bg-green-500"),initial:{width:0},animate:{width:"".concat(r,"%")},transition:{duration:.5}})})}),(0,a.jsxs)("span",{className:"flex-shrink-0 text-sm text-gray-500 w-12",children:[Math.round(r),"%"]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsx)("button",{onClick:()=>b(e._id),disabled:v===e._id,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:v===e._id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})})})]},e._id)}),0===d.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("svg",{className:"w-12 h-12 mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,a.jsx)("p",{className:"text-lg font-medium",children:"No users found"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Try adjusting your search criteria"})]})})})]})]})})]})]})}),(0,a.jsx)("footer",{className:"mt-8 text-center text-gray-500 text-sm"})]})}},5171:(e,t,s)=>{"use strict";s.d(t,{e:()=>r});let a=s(9509).env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:3000/",r=e=>{let t=e.startsWith("/")?e.slice(1):e;return"".concat(a,"/").concat(t)}},6926:(e,t,s)=>{Promise.resolve().then(s.bind(s,1502))}},e=>{var t=t=>e(e.s=t);e.O(0,[285,568,441,684,358],()=>t(6926)),_N_E=e.O()}]);